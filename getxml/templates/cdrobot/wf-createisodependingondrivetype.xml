<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <CdRobot.createIsoDependingOnDriveType
        COMMENT="this workflow has progress 10...60"
        DPFINT-Icon="doc://:/wf.gif"
        DPFINT-Interactive="0"
        DPFINT-Type="WorkflowDescription"
        INTERNALNAME="CdRobot.createIsoDependingOnDriveType"
        NAME="Create ISO Depending On Drive Type"
        PROJECT="CdRobot"
        VERSION="$Id: wf-createisodependingondrivetype.xml,v 1.6 2006/12/15 16:24:05 stefan Exp $"
        >
        <DEFAULTS
          DPFINT-Icon="doc://:/defaults.gif"
          />
        <END
          COMMENT=""
          NAME="END"
          POSX="500"
          POSY="100"
          TYPE="STOP"
          />
        <MAIN
          BEGIN="ifAlreadyHaveIso"
          NAME=""
          />
        <MAPPING/>
        <callClientBuild
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="300"
          POSY="1300"
          TYPE="SWF"
          USE="CdRobot.clientBuild"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </callClientBuild>
        <callServerBuild
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="500"
          POSY="1300"
          TYPE="SWF"
          USE="CdRobot.serverBuild"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </callServerBuild>
        <callUnixBuild
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="800"
          POSY="1300"
          TYPE="SWF"
          USE="CdRobot.unixBuild"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </callUnixBuild>
        <checkDriveType
          COMMENT=""
          DEFAULT="sendWrongDriveTypeMail"
          POSX="500"
          POSY="900"
          PROPERTY="DRIVE_TYPE"
          TYPE="SWITCH"
          >
          <CONNECTIONS
            DEFAULT="VERTICAL"
            LOCAL="VERTICAL"
            NOVELL="VERTICAL"
            REMOTE="VERTICAL"
            SAMBA="VERTICAL"
            SERVER="DIRECT"
            UNIX="VERTICAL"
            />
          <cases
            LOCAL="callClientBuild"
            NOVELL="callClientBuild"
            REMOTE="callClientBuild"
            SAMBA="checkServerType"
            SERVER="callServerBuild"
            UNIX="callUnixBuild"
            />
        </checkDriveType>
        <checkServerType
          COMMENT=""
          ELSE="callServerBuild"
          OPERATOR="eq"
          POSX="700"
          POSY="1100"
          PROPERTY="WANT_UNIX"
          THEN="callUnixBuild"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="VERTICAL"
            />
        </checkServerType>
        <getDriveType
          COMMENT=""
          ERROR="END"
          NAME="CdRobot.getDriveType"
          NEXT="set15"
          POSX="500"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            INPUTPATH="%TARROOTDIR%"
            NET_USE_FILE="%CURRFILENAME%"
            OUTPUTPROPERTY="TARROOTDIR"
            />
        </getDriveType>
        <ifAlreadyHaveIso
          COMMENT=""
          ELSE="ifValidRootDir"
          OPERATOR="is file"
          POSX="100"
          POSY="0"
          PROPERTY="IMAGEFILE"
          THEN="ifAlreadyHaveIso2"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="HORIZONTAL"
            />
        </ifAlreadyHaveIso>
        <ifAlreadyHaveIso2
          COMMENT=""
          ELSE="getDriveType"
          OPERATOR="ends with"
          POSX="200"
          POSY="500"
          PROPERTY="IMAGEFILE"
          THEN="END"
          TYPE="IF-THEN-ELSE"
          VALUE=".iso"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifAlreadyHaveIso2>
        <ifValidRootDir
          COMMENT=""
          ELSE="getDriveType"
          OPERATOR="eq"
          POSX="500"
          POSY="100"
          PROPERTY="TARROOTDIR"
          THEN="sendNoRootDirGivenEMail"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="DIRECT"
            />
        </ifValidRootDir>
        <sendNoRootDirGivenEMail
          COMMENT=""
          ERROR="END"
          NAME="Mail.sendMail"
          NEXT="END"
          POSX="800"
          POSY="100"
          TYPE="WU"
          >
          <DEFAULTS
            EMAIL="%MAIL_DPFADMIN%"
            JOBLOGFILE="%JOBDIR%/job.log"
            MAIL_ATTACH_PROPERTIES="JOBLOGFILE"
            MAIL_EXPAND_TEXT="Y"
            MAIL_SUBJECT="Fehler beim CD Brennauftrag &apos;%MKISO_VOLUME_ID%&apos; mit %TARROOTDIR%"
            MAIL_TEXT="Hallo %JOBUSERNAME%,\n\nbei Deinem CD Brennauftrag trat ein Fehler auf.\n\nFehlergrund: Es wurde kein Quellverzeichnis angegeben."
            MAIL_TO="%EMAIL%"
            MKISO_VOLUME_ID=""
            />
          <MAPPING/>
        </sendNoRootDirGivenEMail>
        <sendWrongDriveTypeMail
          COMMENT=""
          ERROR="END"
          NAME="Mail.sendMail"
          NEXT="END"
          POSX="1000"
          POSY="1300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            EMAIL="%MAIL_DPFADMIN%"
            JOBLOGFILE="%JOBDIR%/job.log"
            MAIL_ATTACH_PROPERTIES="JOBLOGFILE"
            MAIL_CC="%MAIL_DPFADMIN%"
            MAIL_EXPAND_TEXT="Y"
            MAIL_SUBJECT="Fehler beim CD Brennauftrag &apos;%MKISO_VOLUME_ID%&apos; mit %TARROOTDIR%"
            MAIL_TEXT="Hallo %JOBUSERNAME%,\n\nbei Deinem CD Brennauftrag mit dem Verzeichnis %TARROOTDIR%\ntrat ein Fehler auf.\n\nFehlergrund: Es kann nicht von dem angegebenen Pfad gebrannt werden,\nda der Laufwerkstyp nicht erkannt wurde.\n\nFür weitere Details siehe die Job Protokolldatei im Anhang dieser Mail,\noder unter %DPFTRACKERURL%?job=%JOBID% .\n\nDer DPF Systemadministrator wurde ebenfalls informiert."
            MAIL_TO="%EMAIL%"
            MKISO_VOLUME_ID=""
            />
          <MAPPING/>
        </sendWrongDriveTypeMail>
        <set15
          COMMENT=""
          NEXT="checkDriveType"
          POSX="500"
          POSY="700"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF_JOB_PROGRESS="15"
            />
        </set15>
      </CdRobot.createIsoDependingOnDriveType>
    </workflows>
  </config>
</DPF>
