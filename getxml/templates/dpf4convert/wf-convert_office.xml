<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <DPF4CONVERT.convert_office
        COMMENT="dpf4convert - SUBPROCESS CONVERT OFFICE.
This subprocess is used to convert Office-Formats. It is used from the main processes like SAP_CONVERT_OFFICE and NET_CONVERT_OFFICE inbetween the checkin and checkout subprocesses."
        DPFINT-Customer="0"
        DPFINT-Interactive="0"
        DPFINT-Type="WorkflowDescription"
        NAME="Convert Office - SubProcess Convert Office"
        PROJECT="DPF4CONVERT"
        VERSION="$Id: wf-convert_office.xml,v 1.11 2017/06/19 12:43:01 kig Exp $"
        >
        <DEFAULTS/>
        <DPF4CONVERT.dpf4c_user_pre_officeconv1
          COMMENT=""
          ERROR="END"
          NEXT="check_enable"
          POSX="300"
          POSY="300"
          TYPE="SWF"
          USE="DPF4CONVERT.dpf4c_user_pre_officeconv"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.dpf4c_user_pre_officeconv1>
        <DPF4CONVERT.netconv_check_abort
          COMMENT=""
          ERROR="END"
          NEXT="set_pdf_status"
          POSX="200"
          POSY="400"
          TYPE="SWF"
          USE="DPF4CONVERT.netconv_check_abort"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.netconv_check_abort>
        <END
          COMMENT=""
          NAME="END"
          POSX="1200"
          POSY="1800"
          TYPE="STOP"
          />
        <MAIN
          BEGIN="check_user_pre_officeconv"
          ERROR="END"
          LOGLEVEL="I"
          />
        <MAPPING/>
        <OOCalcToPdf
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="800"
          POSY="1100"
          TYPE="SWF"
          USE="DPF4CONVERT.OpenDocument2PDF"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </OOCalcToPdf>
        <OODrawToPdf
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="1000"
          POSY="1100"
          TYPE="SWF"
          USE="DPF4CONVERT.OpenDocument2PDF"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </OODrawToPdf>
        <OOImpressToPdf
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="900"
          POSY="1000"
          TYPE="SWF"
          USE="DPF4CONVERT.OpenDocument2PDF"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </OOImpressToPdf>
        <OOWriterToPdf
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="700"
          POSY="1000"
          TYPE="SWF"
          USE="DPF4CONVERT.OpenDocument2PDF"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </OOWriterToPdf>
        <check_currfiletyp
          CASE:eml="msg2pdf"
          CASE:msg="msg2pdf"
          CASE:odg="OODrawToPdf"
          CASE:odp="OOImpressToPdf"
          CASE:ods="OOCalcToPdf"
          CASE:odt="OOWriterToPdf"
          CASE:otg="OODrawToPdf"
          CASE:otp="OOImpressToPdf"
          CASE:ots="OOCalcToPdf"
          CASE:ott="OOWriterToPdf"
          COMMENT=""
          CONNECTION:DEFAULT="DIRECT"
          CONNECTION:eml="VERTICAL"
          CONNECTION:msg="VERTICAL"
          CONNECTION:odg="VERTICAL"
          CONNECTION:odp="VERTICAL"
          CONNECTION:ods="VERTICAL"
          CONNECTION:odt="VERTICAL"
          CONNECTION:otg="VERTICAL"
          CONNECTION:otp="VERTICAL"
          CONNECTION:ots="VERTICAL"
          CONNECTION:ott="VERTICAL"
          DEFAULT="office2ps"
          POSX="200"
          POSY="800"
          PROPERTY="CURRFILETYPE"
          TYPE="SWITCH"
          />
        <check_currfiletype
          COMMENT=""
          ELSE="DPF4CONVERT.netconv_check_abort"
          OPERATOR="eq"
          POSX="600"
          POSY="200"
          PROPERTY="CURRFILETYPE"
          THEN="END"
          TYPE="IF-THEN-ELSE"
          VALUE="pdf"
          >
          <CONNECTIONS
            ELSE="HORIZONTAL"
            THEN="DIRECT"
            />
        </check_currfiletype>
        <check_enable
          COMMENT=""
          ELSE="check_currfiletype"
          OPERATOR="eq"
          POSX="400"
          POSY="200"
          PROPERTY="ENABLE_OFFICECONV"
          THEN="END"
          TYPE="IF-THEN-ELSE"
          VALUE="N"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_enable>
        <check_filetype_ps
          COMMENT=""
          ELSE="END"
          OPERATOR="eq"
          POSX="200"
          POSY="1200"
          PROPERTY="CURRFILETYPE"
          THEN="ps2pdfg2"
          TYPE="IF-THEN-ELSE"
          VALUE="ps"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_filetype_ps>
        <check_num_metadata
          COMMENT=""
          ELSE="clear_outfile_ps"
          OPERATOR="ge"
          POSX="200"
          POSY="1600"
          PROPERTY="DPF4C_NUM_METADATA_PROPERTIES"
          THEN="set_pdf_metadata_later"
          TYPE="IF-THEN-ELSE"
          VALUE="1"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_num_metadata>
        <check_user_pre_officeconv
          COMMENT=""
          ELSE="check_enable"
          OPERATOR="eq"
          POSX="200"
          POSY="200"
          PROPERTY="DPF4C_SWITCH_USER_PRE_OFFICECONV"
          THEN="DPF4CONVERT.dpf4c_user_pre_officeconv1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_user_pre_officeconv>
        <clear_outfile_ps
          COMMENT=""
          NEXT="END"
          POSX="200"
          POSY="1800"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_COMMON_OUTFILEps=""
            />
        </clear_outfile_ps>
        <msg2pdf
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="500"
          POSY="1000"
          TYPE="SWF"
          USE="msg2pdf"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </msg2pdf>
        <office2ps
          COMMENT=""
          ERROR="END"
          NEXT="check_filetype_ps"
          POSX="200"
          POSY="1000"
          TYPE="SWF"
          USE="office2ps"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </office2ps>
        <ps2pdfg2
          COMMENT=""
          ERROR="END"
          NEXT="check_num_metadata"
          POSX="200"
          POSY="1400"
          TYPE="SWF"
          USE="ps2pdfg"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </ps2pdfg2>
        <set_pdf_metadata_later
          COMMENT=""
          NEXT="clear_outfile_ps"
          POSX="400"
          POSY="1700"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_SET_PDF_META_DATA="Y"
            />
        </set_pdf_metadata_later>
        <set_pdf_status
          COMMENT=""
          NEXT="check_currfiletyp"
          POSX="200"
          POSY="600"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            PDFFILE_STATUS="converted"
            />
        </set_pdf_status>
      </DPF4CONVERT.convert_office>
    </workflows>
  </config>
</DPF>
