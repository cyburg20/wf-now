<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <DPF4CONVERT.check_application_type
        COMMENT="Check what type of application the input format is: native or office"
        DPFINT-Customer="0"
        DPFINT-Interactive="0"
        DPFINT-Type="WorkflowDescription"
        NAME="Check Application Type"
        OrigIdentifier="WorkflowDPF4CONVERT.check_application_type"
        PROJECT="DPF4CONVERT"
        VERSION="$Id: wf-check_application_type.xml,v 1.5 2017/01/26 06:51:28 kig Exp $"
        >
        <DEFAULTS
          DPF4C_FILETYPES_NATIVE="bmp,cgm,cls,dcx,eps,gif,hp,hpgl,htm,html,jpeg,jpg,mhtm,mhtml,otf,pcx,pdf,png,ps,tif,tiff,txt,xps,zip"
          DPF4C_FILETYPES_OFFICE="cdr,doc,docm,docx,dot,dotm,dotx,eml,mpp,mpv,msg,odg,odp,ods,odt,otg,otp,ots,ott,pot,potm,potx,pps,ppsm,ppsx,ppt,pptm,pptx,rtf,txt,vdx,vsd,vsdx,vsdm,vss,vst,vsx,vssx,vssm,vstx,vstm,xla,xlam,xls,xlsb,xlsm,xlsx,xlt,xltm,xltx"
          DPF4C_FILETYPES_UNSUPPORTED="des,dsf,pub,wpd,all_cad_formats"
          />
        <END
          COMMENT=""
          NAME="END"
          POSX="500"
          POSY="100"
          TYPE="STOP"
          />
        <MAIN
          BEGIN="set_lists"
          NAME=""
          />
        <MAPPING/>
        <check_native_types
          COMMENT=""
          ELSE="set_unknown_type"
          OPERATOR="contains"
          POSX="400"
          POSY="300"
          PROPERTY="LIST_FILETYPES_NATIVE"
          THEN="set_native_type"
          TYPE="IF-THEN-ELSE"
          VALUE="%LIST_CURRFILETYPE%"
          >
          <CONNECTIONS
            ELSE="HORIZONTAL"
            THEN="DIRECT"
            />
        </check_native_types>
        <check_office_types
          COMMENT=""
          ELSE="check_native_types"
          OPERATOR="contains"
          POSX="400"
          POSY="100"
          PROPERTY="LIST_FILETYPES_OFFICE"
          THEN="set_office_type"
          TYPE="IF-THEN-ELSE"
          VALUE="%LIST_CURRFILETYPE%"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_office_types>
        <set_lists
          COMMENT=""
          NEXT="check_office_types"
          POSX="200"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            LIST_CURRFILETYPE=",%CURRFILETYPE%,"
            LIST_FILETYPES_NATIVE=",%DPF4C_FILETYPES_NATIVE%,"
            LIST_FILETYPES_OFFICE=",%DPF4C_FILETYPES_OFFICE%,"
            />
        </set_lists>
        <set_native_type
          COMMENT=""
          NEXT="END"
          POSX="600"
          POSY="300"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_APPLICATION_TYPE="native"
            />
        </set_native_type>
        <set_office_type
          COMMENT=""
          NEXT="END"
          POSX="600"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_APPLICATION_TYPE="office"
            />
        </set_office_type>
        <set_unknown_type
          COMMENT=""
          NEXT="END"
          POSX="600"
          POSY="500"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_APPLICATION_TYPE="unknown"
            />
        </set_unknown_type>
      </DPF4CONVERT.check_application_type>
    </workflows>
  </config>
</DPF>
