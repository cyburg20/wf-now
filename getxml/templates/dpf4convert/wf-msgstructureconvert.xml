<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <DPF4CONVERT.msgstructureconvert
        COMMENT=""
        DPFINT-Type="WorkflowDescription"
        NAME="msgstructureconvert"
        PROJECT="DPF4CONVERT"
        VERSION="$Id: wf-msgstructureconvert.xml,v 1.8 2015/06/22 09:11:51 kig Exp $"
        >
        <DEFAULTS/>
        <DPF4CONVERT.Convertmsg
          COMMENT=""
          ERROR="END"
          NAME="DPF4CONVERT.Convertmsg"
          NEXT="MSG2PDF_SKIP_MERGE"
          POSX="1200"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.Convertmsg>
        <DPF4CONVERT.msg2struct
          COMMENT=""
          ERROR="END"
          NAME="DPF4CONVERT.msg2struct"
          NEXT="check_for_ignore_error"
          POSX="800"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            MSG2PDF_EXTRACT_MSG_ATTACH="Y"
            MSG2PDF_IGNORE_FILETYPE="vcf exe com bat dll"
            MSG2PDF_SAVEBODYASTEXT="N"
            MSG2PDF_WRITE_RLI="N"
            MSG2PDF_WRITE_XML="Y"
            />
          <MAPPING/>
        </DPF4CONVERT.msg2struct>
        <END
          COMMENT=""
          NAME="END"
          POSX="200"
          POSY="100"
          TYPE="STOP"
          />
        <MAIN
          BEGIN="check_for_supported_formats"
          NAME=""
          />
        <MAPPING/>
        <MSG2PDF_SKIP_MERGE
          COMMENT=""
          ELSE="check_user_exit"
          OPERATOR="is true"
          POSX="1400"
          POSY="300"
          PROPERTY="MSG2PDF_SKIP_MERGE"
          THEN="setreturnproperties"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </MSG2PDF_SKIP_MERGE>
        <Merge_Attachments
          COMMENT=""
          ERROR="END"
          NAME="Pdf.merge"
          NEXT="Modify_Currfiletype"
          POSX="1800"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS
            PdfMergeBookmarkFileName="%BOOKMARKFILE%"
            PdfMergeListFileName="%MAILMERGELIST%"
            PdfMergeMakePDFA="%CREATE_PDFA%"
            />
          <MAPPING/>
        </Merge_Attachments>
        <Modify_Currfiletype
          COMMENT=""
          NEXT="END"
          POSX="2000"
          POSY="300"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            CURRFILETYPE="pdf"
            />
        </Modify_Currfiletype>
        <check_for_ignore_error
          COMMENT=""
          ELSE="DPF4CONVERT.Convertmsg"
          OPERATOR="is true"
          POSX="1000"
          POSY="300"
          PROPERTY="MSG2PDF_IGNORE_CONVERT_ERROR"
          THEN="set_fallback_on_error"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_for_ignore_error>
        <check_for_supported_formats
          COMMENT=""
          ELSE="DPF4CONVERT.msg2struct"
          OPERATOR="eq"
          POSX="600"
          POSY="300"
          PROPERTY="PST_SUPPORTED_FORMATS"
          THEN="setup_default_supported_formats"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_for_supported_formats>
        <check_user_exit
          COMMENT=""
          ELSE="msg2pdf_user_pre_merge"
          OPERATOR="eq"
          POSX="1600"
          POSY="300"
          PROPERTY="Msg2PdfUserPreMerge"
          THEN="Merge_Attachments"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_user_exit>
        <msg2pdf_user_pre_merge
          COMMENT=""
          ERROR="END"
          NEXT="Merge_Attachments"
          POSX="1700"
          POSY="500"
          TYPE="USER_EXIT"
          USE="%Msg2PdfUserPreMerge%"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </msg2pdf_user_pre_merge>
        <set_fallback_on_error
          COMMENT=""
          NEXT="DPF4CONVERT.Convertmsg"
          POSX="1000"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="VERTICAL"
            />
          <SET
            FALLBACKONERROR="IGNORE"
            />
        </set_fallback_on_error>
        <setreturnproperties
          COMMENT=""
          NEXT="END"
          POSX="1400"
          POSY="500"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            STRUCTURED_RESULT_FILE="%CURRFILENAME%"
            />
        </setreturnproperties>
        <setup_default_supported_formats
          COMMENT=""
          NEXT="DPF4CONVERT.msg2struct"
          POSX="600"
          POSY="500"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="VERTICAL"
            />
          <SET
            PST_SUPPORTED_FORMATS="doc docx docm rtf dot dotx dotm xls xlsx xlsm xlsb xla xlam xlt xltx xltm potx potm pps ppsx ppsm ppt pptx pptm tif pdf jpg gif msg ps txt html png bmp eml"
            />
        </setup_default_supported_formats>
      </DPF4CONVERT.msgstructureconvert>
    </workflows>
  </config>
</DPF>
