<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <Publish.MergeAndStampDocuments
        COMMENT=""
        DPFINT-Customer="0"
        DPFINT-Icon="doc://:/wf.gif"
        DPFINT-Interactive="1"
        DPFINT-Type="WorkflowDescription"
        NAME="Direct Publishing - Merge and Stamp PDF Documents"
        PROJECT="Publish"
        VERSION="$Id: wf-mergeandstampdocuments.xml,v 1.2 2015/09/24 15:52:40 sek Exp $"
        >
        <AppendSkipStampColumn
          COMMENT=""
          ERROR="END"
          NAME="Rli.appendColumn"
          NEXT="ReadSections"
          POSX="400"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            AppendColumns="SKIP_STAMP"
            />
        </AppendSkipStampColumn>
        <CopyPdfFile
          COMMENT="Kopiere fertiges PDF an Zielort"
          ERROR="END"
          NAME="FileTransfer.copyFiles"
          NEXT="END"
          POSX="400"
          POSY="1900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            COPY_SOURCE_PROPERTIES="CURRFILENAME"
            COPY_TARGET_PROPERTIES="TARGETFILENAME"
            NAME="DEFAULTS"
            />
          <MAPPING/>
        </CopyPdfFile>
        <DEFAULTS
          DPF_DEBUG_SUBJOBS="Y"
          />
        <END
          COMMENT=""
          NAME="END"
          POSX="700"
          POSY="2100"
          TYPE="STOP"
          />
        <GetFileNamesFromRli
          COMMENT="ermittle Dateiliste aus Reproliste für PDF Merge	"
          ERROR="END"
          NAME="Rli.getFileNames"
          NEXT="MergeCoverTocAndAllDocs"
          POSX="400"
          POSY="1300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            FILTER_VALUE=""
            RLIC_FILTER=""
            />
          <MAPPING/>
        </GetFileNamesFromRli>
        <GetPageNumbersFromRli
          COMMENT="ermittle Seitenzahlen aller PDFs aus der RLI"
          ERROR="END"
          NAME="Rli.getPageNumbers"
          NEXT="StampPdfs"
          POSX="400"
          POSY="900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </GetPageNumbersFromRli>
        <IfRli
          COMMENT="Handelt es sich um eine Reproliste?"
          ELSE="InputFileNotRli"
          OPERATOR="ends with"
          POSX="400"
          POSY="300"
          PROPERTY="CURRRLIFILENAME"
          THEN="AppendSkipStampColumn"
          TYPE="IF-THEN-ELSE"
          VALUE="rli"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="VERTICAL"
            />
        </IfRli>
        <InputFileNotRli
          COMMENT=""
          ERROR="END"
          NAME="error"
          NEXT="END"
          POSX="600"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <ERR_CODE
              val="1"
              />
          </DEFAULTS>
          <MAPPING
            ERR_REASON="Input file must be a reprolist!"
            />
        </InputFileNotRli>
        <MAIN
          BEGIN="SetRliFileName"
          NAME=""
          />
        <MAPPING/>
        <MergeCoverTocAndAllDocs
          COMMENT="Merge aller PDF-Dateien (Deckblatt, Inhaltsverzeichnis und alle Dokumente)"
          ERROR="END"
          NAME="Pdf.merge"
          NEXT="StampPageNumbers"
          POSX="400"
          POSY="1500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            NAME="DEFAULTS"
            />
          <MAPPING/>
        </MergeCoverTocAndAllDocs>
        <ReadSections
          COMMENT="Lies Standardwerte aus der Reproliste"
          ERROR="END"
          NAME="Rli.readSections"
          NEXT="GetPageNumbersFromRli"
          POSX="400"
          POSY="700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </ReadSections>
        <SetRliFileName
          COMMENT="setze RLI Auftragsdatei"
          NEXT="IfRli"
          POSX="400"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            CURRRLIFILENAME="%CURRFILENAME%"
            />
        </SetRliFileName>
        <StampPageNumbers
          COMMENT="laufende Seitennummer auf gemergtes PDF stempeln"
          ERROR="END"
          NAME="Publish.stampPageNumbers"
          NEXT="CopyPdfFile"
          POSX="400"
          POSY="1700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            FILTERVALUE=""
            NAME="DEFAULTS"
            RLIC_FILTER="SKIP_STAMP"
            />
          <MAPPING/>
        </StampPageNumbers>
        <StampPdfs
          COMMENT=""
          ERROR="END"
          NAME="Rli.stampPdfs"
          NEXT="GetFileNamesFromRli"
          POSX="400"
          POSY="1100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            PDFSTAMP_DB_FILENAME="%PLSSV%/dpf/conf/publish/stampmergeddocs.db"
            PDFSTAMP_STP_FILENAME="%PLSSV%/dpf/conf/publish/stampmergeddocs.stp"
            StampTextFromRlic="PLS_STAMP_*"
            >
            <PDFSTAMP_ODD_EVEN_DIFFERENT
              val="N"
              />
            <UsePdfStpFileNameAsWatermark
              val="N"
              />
          </DEFAULTS>
          <MAPPING/>
        </StampPdfs>
      </Publish.MergeAndStampDocuments>
    </workflows>
  </config>
</DPF>
