<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <Publish.createDocument
        COMMENT="Direct Publishing Hauptworkflow.

Erzeuge ein PDF-Dokument mit Inhaltsverzeichnis und Seitennumerierung aus einer Reproliste.

"
        DPFINT-Customer="0"
        DPFINT-Icon="doc://:/wf.gif"
        DPFINT-Interactive="1"
        DPFINT-Type="WorkflowDescription"
        NAME="Direct Publishing - Create a PDF Document"
        PROJECT="Publish"
        VERSION="$Id: wf-createdocument.xml,v 1.46 2010/04/20 14:13:20 sek Exp $"
        >
        <ActivateConversionOfAllNonPdfs
          COMMENT="Bei der Konvertierung alle Dokumente ignorieren, die schon im PDF sind."
          ERROR="ErrorHandling"
          NAME="Rli.fillRliColumn"
          NEXT="convertAllNonPdfs"
          POSX="600"
          POSY="1300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <Replacement
              val="_"
              />
            <WuEnableDebugLoop
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            FillColumn="CONVERT_DOCUMENT"
            FillData="y"
            FilterOperator2="!~"
            FilterOperator="-f"
            FilterValue2="/\.pdf$/i"
            RlicFilter2="CURRFILENAME"
            RlicFilter="CURRFILENAME"
            />
        </ActivateConversionOfAllNonPdfs>
        <AddPathToTargetFileNames
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.fillRliColumn"
          NEXT="CopyAllFilesFromRli"
          POSX="400"
          POSY="5100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <Replacement
              val="_"
              />
            <WuEnableDebugLoop
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            FillColumn="TargetFileName"
            FillData="%COPY_TARGETDIR%/%%RelFileName%%"
            FilterOperator2="ne"
            FilterOperator="ne"
            RlicFilter2="RelFileName"
            RlicFilter="CurrFileName"
            />
        </AddPathToTargetFileNames>
        <CopyAdditionalFiles
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="FileTransfer.xcopyDir"
          NEXT="Publish.userExitPostprocessRli1"
          POSX="400"
          POSY="5900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            SOURCEDIR="%COPY_ADDITIONAL_FILES_DIR%"
            TARGETDIR="%COPY_TARGETDIR%"
            />
        </CopyAdditionalFiles>
        <CopyAllFilesFromRli
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.copyFiles"
          NEXT="IfToc4"
          POSX="400"
          POSY="5300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            FilterOperator="-f"
            RlicFilter="CurrFileName"
            />
        </CopyAllFilesFromRli>
        <CopyToc
          COMMENT="copy the table of contents containing links and bookmarks"
          ERROR="ErrorHandling"
          NAME="FileTransfer.copyFiles"
          NEXT="IfCopyAdditionalFiles"
          POSX="200"
          POSY="5500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS>
            <COPY_DEBUG
              val="N"
              />
            <WU_ENABLE_DEBUG_LOOP
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            COPY_SOURCE_PROPERTIES="CurrFileName"
            COPY_TARGET_PROPERTIES="IndexTargetFileName"
            IndexTargetFileName="%COPY_TARGETDIR%/%CUSTOMER_TOC_FILE_NAME%"
            />
        </CopyToc>
        <DEFAULTS
          DPF_DEBUG_SUBJOBS="Y"
          />
        <DecryptAllPdfs
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.DecryptAllPdfsOfRli"
          NEXT="Publish.UserExitBeforeOutputTypeSelection1"
          POSX="200"
          POSY="3100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS>
            <Decryptall
              val="Y"
              />
            <WuEnableDebugLoop
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            FilterOperator2="=~"
            FilterOperator="-f"
            FilterValue2="/\.pdf$/i"
            RlicFilter2="CurrFileName"
            RlicFilter="CurrFileName"
            />
        </DecryptAllPdfs>
        <DoNotMergeDuplicates
          COMMENT=""
          NEXT="doNotStampDuplicates"
          POSX="800"
          POSY="700"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="HORIZONTAL"
            />
          <SET
            IgnoreDuplicates_FilterOperator="ne"
            IgnoreDuplicates_FilterValue="Y"
            IgnoreDuplicates_RlicFilter="Duplicate"
            />
        </DoNotMergeDuplicates>
        <END
          COMMENT=""
          NAME="END"
          POSX="800"
          POSY="6100"
          TYPE="STOP"
          />
        <ErrorHandling
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="1000"
          POSY="6100"
          TYPE="SWF"
          USE="Publish.error"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </ErrorHandling>
        <IfCopyAdditionalFiles
          COMMENT=""
          ELSE="Publish.userExitPostprocessRli1"
          OPERATOR="is true"
          POSX="400"
          POSY="5700"
          PROPERTY="WANT_COPY_ADDITIONAL_FILES"
          THEN="CopyAdditionalFiles"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="DIRECT"
            />
        </IfCopyAdditionalFiles>
        <IfIgnoreDuplicates
          COMMENT=""
          ELSE="MergeDuplicates"
          OPERATOR="is true"
          POSX="400"
          POSY="700"
          PROPERTY="WANT_IGNORE_DUPLICATES"
          THEN="findDuplicateLines"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfIgnoreDuplicates>
        <IfMail
          COMMENT="soll eine EMail gesendet werden?"
          ELSE="END"
          OPERATOR="is true"
          POSX="700"
          POSY="6300"
          PROPERTY="SENDMAIL"
          THEN="sendMail"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfMail>
        <IfMultiPdfOutput
          COMMENT=""
          ELSE="getFileNamesFromRli"
          OPERATOR="eq"
          POSX="400"
          POSY="3500"
          PROPERTY="PLS_PLOTTER"
          THEN="IfToc2"
          TYPE="IF-THEN-ELSE"
          VALUE="PDFOUT-MULTI"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfMultiPdfOutput>
        <IfMultiPdfOutputCOPY
          COMMENT=""
          ELSE="cryptPdf"
          OPERATOR="eq"
          POSX="400"
          POSY="4700"
          PROPERTY="PLS_PLOTTER"
          THEN="ifCopyTargetDir"
          TYPE="IF-THEN-ELSE"
          VALUE="PDFOUT-MULTI"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfMultiPdfOutputCOPY>
        <IfMultiPdfOutputCOPY1
          COMMENT=""
          ELSE="stampPageNumbers"
          OPERATOR="eq"
          POSX="0"
          POSY="4300"
          PROPERTY="PLS_PLOTTER"
          THEN="Rli.stampPdfs1"
          TYPE="IF-THEN-ELSE"
          VALUE="PDFOUT-MULTI"
          >
          <CONNECTIONS
            ELSE="HORIZONTAL"
            THEN="HORIZONTAL"
            />
        </IfMultiPdfOutputCOPY1>
        <IfPageNumbers
          COMMENT=""
          ELSE="Publish.userExitBeforeCopyTarget1"
          OPERATOR="is true"
          POSX="400"
          POSY="4300"
          PROPERTY="WANT_PAGE_NUMBERS"
          THEN="IfMultiPdfOutputCOPY1"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfPageNumbers>
        <IfReadRliSections
          COMMENT=""
          ELSE="ifCoverCOPY"
          OPERATOR="is true"
          POSX="400"
          POSY="1100"
          PROPERTY="WANT_READ_RLI_SECTIONS"
          THEN="readRliSections"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfReadRliSections>
        <IfToc
          COMMENT=""
          ELSE="ifCover2"
          OPERATOR="is true"
          POSX="400"
          POSY="2500"
          PROPERTY="WANT_TOC"
          THEN="userExitBeforeToc"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfToc>
        <IfToc2
          COMMENT=""
          ELSE="IfToc3"
          OPERATOR="is true"
          POSX="600"
          POSY="3500"
          PROPERTY="WANT_TOC"
          THEN="Rli.insertPdfBackLinks1"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="HORIZONTAL"
            THEN="VERTICAL"
            />
        </IfToc2>
        <IfToc3
          COMMENT=""
          ELSE="IfPageNumbers"
          OPERATOR="is true"
          POSX="400"
          POSY="4100"
          PROPERTY="WANT_TOC"
          THEN="setBookmarks"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfToc3>
        <IfToc4
          COMMENT=""
          ELSE="IfCopyAdditionalFiles"
          OPERATOR="is true"
          POSX="400"
          POSY="5500"
          PROPERTY="WANT_TOC"
          THEN="CopyToc"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfToc4>
        <MAIN
          BEGIN="ifRliFileExists"
          NAME=""
          />
        <MAPPING/>
        <MODIFY1
          COMMENT="only seperatefiles in this case, so use the content to set the bookmarks"
          NEXT="IfToc3"
          POSX="800"
          POSY="3900"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="HORIZONTAL"
            />
          <SET
            CurrFileName="%TOC%"
            />
        </MODIFY1>
        <MergeDuplicates
          COMMENT=""
          NEXT="IfReadRliSections"
          POSX="400"
          POSY="900"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            IgnoreDuplicates_FilterOperator=""
            IgnoreDuplicates_FilterValue=""
            IgnoreDuplicates_RlicFilter=""
            />
        </MergeDuplicates>
        <Publish.UserExitBeforeOutputTypeSelection1
          COMMENT=""
          ERROR="ErrorHandling"
          NEXT="IfMultiPdfOutput"
          POSX="400"
          POSY="3300"
          TYPE="SWF"
          USE="Publish.UserExitBeforeOutputTypeSelection"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </Publish.UserExitBeforeOutputTypeSelection1>
        <Publish.userExitBeforeCopyTarget1
          COMMENT=""
          ERROR="ErrorHandling"
          NEXT="IfMultiPdfOutputCOPY"
          POSX="400"
          POSY="4500"
          TYPE="SWF"
          USE="Publish.userExitBeforeCopyTarget"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </Publish.userExitBeforeCopyTarget1>
        <Publish.userExitPostprocessRli1
          COMMENT=""
          ERROR="ErrorHandling"
          NEXT="cleanup"
          POSX="700"
          POSY="5900"
          TYPE="SWF"
          USE="Publish.userExitPostprocessRli"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </Publish.userExitPostprocessRli1>
        <Rli.insertPdfBackLinks1
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.insertPdfBackLinks"
          NEXT="MODIFY1"
          POSX="800"
          POSY="3700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <IgnoreErrors
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            IndexFileName="%CUSTOMER_TOC_FILE_NAME%"
            />
        </Rli.insertPdfBackLinks1>
        <Rli.stampPdfs1
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.stampPdfs"
          NEXT="Publish.userExitBeforeCopyTarget1"
          POSX="200"
          POSY="4500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            PDFSTAMP_DB_FILENAME="%PDFOUT-MULTI_DB_FILENAME%"
            PDFSTAMP_STP_FILENAME="%PDFOUT-MULTI_STP_FILENAME%"
            PDFSTAMP_TXT_FILENAME="%PDFOUT-MULTI_TXT_FILENAME%"
            RlicFilter="SkipStamp"
            >
            <PDFSTAMP_ODD_EVEN_DIFFERENT
              val="N"
              />
            <UsePdfStpFileNameAsWatermark
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            PdfStampPagesValue="%TotalPages%"
            RlicPageValue="PAGENUMBER"
            />
        </Rli.stampPdfs1>
        <UserExitCustomPageNumberCollection
          COMMENT=""
          ERROR="ErrorHandling"
          NEXT="ifCover"
          POSX="200"
          POSY="1700"
          TYPE="SWF"
          USE="Publish.UserExitCustomPageNumberCollection"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </UserExitCustomPageNumberCollection>
        <WantCustomPageNumberCollection
          COMMENT="Extra WU für das ermitteln der Seitenzahlen nötig?"
          ELSE="getPageNumbersFromRli"
          OPERATOR="is true"
          POSX="400"
          POSY="1500"
          PROPERTY="WantCustomPageNumberCollection"
          THEN="UserExitCustomPageNumberCollection"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="VERTICAL"
            />
        </WantCustomPageNumberCollection>
        <appendSkipStampColumn
          COMMENT="RLI-Spalte zum Überspringen der Seitenstempel eintragen."
          ERROR="ErrorHandling"
          NAME="Rli.appendColumn"
          NEXT="ifCover"
          POSX="400"
          POSY="2100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            APPENDCOLUMNS="SKIP_STAMP"
            />
          <MAPPING/>
        </appendSkipStampColumn>
        <appendTocTypeColumnCOPY
          COMMENT="neue RLI Spalte TOCTYPE für Inhaltsverzeichnis eintragen"
          ERROR="END"
          NAME="Rli.appendColumn"
          NEXT="fillTocTypeColumnCOPY"
          POSX="1100"
          POSY="2500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS
            APPENDCOLUMNS="TOCTYPE"
            />
          <MAPPING/>
        </appendTocTypeColumnCOPY>
        <cleanup
          COMMENT="Gegebenenfalls aufräumen"
          ERROR="ErrorHandling"
          NEXT="IfMail"
          POSX="700"
          POSY="6100"
          TYPE="SWF"
          USE="Publish.cleanup"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </cleanup>
        <convertAllNonPdfs
          COMMENT="Konvertiere alle Dateien aus der Reproliste nach PDF.

Es wird pro Dokument der Workflow Rli.convertFilesHelper aufgerufen, der wiederum den Workflow dpf4convert verwendet. Dort wird nach PDF gewandelt und auch gestempelt."
          ERROR="ErrorHandling"
          NAME="Rli.convertFiles"
          NEXT="ifSingleConvert"
          POSX="800"
          POSY="1300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS
            CURRFILENAME=""
            NAME="DEFAULTS"
            SUB_WFNAME="Rli.convertFilesHelper"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING/>
        </convertAllNonPdfs>
        <copyPdfFile
          COMMENT="Kopiere fertiges PDF an Zielort"
          ERROR="ErrorHandling"
          NAME="FileTransfer.copyFiles"
          NEXT="Publish.userExitPostprocessRli1"
          POSX="800"
          POSY="5300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="VERTICAL"
            />
          <DEFAULTS
            COPY_SOURCE_PROPERTIES="CURRFILENAME"
            COPY_TARGET_PROPERTIES="COPY_TARGETFILE"
            NAME="DEFAULTS"
            />
          <MAPPING/>
        </copyPdfFile>
        <createCoverSheet
          COMMENT="Erzeuge Deckblatt"
          ERROR="ErrorHandling"
          NAME="Publish.createCoverSheet"
          NEXT="IfToc"
          POSX="800"
          POSY="2300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            COVER_BACKGROUND_PDF="%DPFSRV%/conf/solystic/PAGE-GARDE.pdf"
            COVER_TARGET="%JOBDIR%/cover.pdf"
            COVER_TEXT1=""
            COVER_TEXT1_ALIGN="left"
            COVER_TEXT1_SIZE="20"
            COVER_TEXT1_X="10.5 cm"
            COVER_TEXT1_Y="15 cm"
            COVER_TEXT2=""
            COVER_TEXT2_ALIGN="left"
            COVER_TEXT2_SIZE="20"
            COVER_TEXT2_X="10.5 cm"
            COVER_TEXT2_Y="14 cm"
            LABEL_LIST="COVER_TEXT1 COVER_TEXT2"
            NAME="DEFAULTS"
            />
          <MAPPING
            LABEL_LIST="%COVER_LABEL_LIST%"
            />
        </createCoverSheet>
        <createTargetPath
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="FileSystem.mkPath"
          NEXT="copyPdfFile"
          POSX="800"
          POSY="5100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <DIRECTORY
              val=""
              />
          </DEFAULTS>
          <MAPPING
            DIRECTORY="%COPY_TARGETFILE.dirName%"
            />
        </createTargetPath>
        <createToc
          COMMENT="erzeuge Inhaltsverzeichnis und Bookmark-Metadaten"
          ERROR="ErrorHandling"
          NAME="Publish.createContents"
          NEXT="appendTocTypeColumnCOPY"
          POSX="800"
          POSY="2500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            CREATETOCPDF_PAGE_OFFSET="1"
            CREATETOCPDF_SIMPLE_PAGE_ENUMERATION="Y"
            FilterOperator="%IgnoreDuplicates_FilterOperator%"
            FilterValue="%IgnoreDuplicates_FilterValue%"
            NAME="DEFAULTS"
            RlicFilter="%IgnoreDuplicates_RlicFilter%"
            />
          <MAPPING
            DestFileName=""
            />
        </createToc>
        <cryptPdf
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="pdfauthorize"
          NEXT="ifCopyTargetPdf"
          POSX="600"
          POSY="4700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <DPF4C_AUTHORIZE_ACTIVATE
              val="N"
              />
            <DPF4C_AUTHORIZE_ADDNOTES
              val="Y"
              />
            <DPF4C_AUTHORIZE_ASSEMBLE
              val="Y"
              />
            <DPF4C_AUTHORIZE_BRAILLE
              val="Y"
              />
            <DPF4C_AUTHORIZE_CHANGE
              val="N"
              />
            <DPF4C_AUTHORIZE_CHANGE_PW
              val=""
              />
            <DPF4C_AUTHORIZE_COPY_TEXT
              val="Y"
              />
            <DPF4C_AUTHORIZE_DECRYPT
              val="N"
              />
            <DPF4C_AUTHORIZE_DECRYPT_ALL
              val="N"
              />
            <DPF4C_AUTHORIZE_ENCRYPTION128
              val="N"
              />
            <DPF4C_AUTHORIZE_FILLFIELDS
              val="N"
              />
            <DPF4C_AUTHORIZE_LOWRES
              val="N"
              />
            <DPF4C_AUTHORIZE_OPEN_PW
              val=""
              />
            <DPF4C_AUTHORIZE_OWNER_PW
              val=""
              />
            <DPF4C_AUTHORIZE_PRINT
              val="N"
              />
            <DPF4C_AUTHORIZE_USER_PW
              val=""
              />
            <WU_ENABLE_DEBUG_LOOP
              val="N"
              />
          </DEFAULTS>
          <MAPPING/>
        </cryptPdf>
        <doNotStampDuplicates
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.fillRliColumn"
          NEXT="IfReadRliSections"
          POSX="600"
          POSY="1100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <Replacement
              val="_"
              />
            <WuEnableDebugLoop
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            FillColumn="SKIP_STAMP"
            FillData="Y"
            FilterOperator="eq"
            FilterValue="Y"
            RlicFilter="Duplicate"
            />
        </doNotStampDuplicates>
        <fillEmptyPageNumbers
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Publish.fillEmptyPageNumbers"
          NEXT="appendSkipStampColumn"
          POSX="400"
          POSY="1900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </fillEmptyPageNumbers>
        <fillTocTypeColumnCOPY
          COMMENT="RLI Spalte TOCTYPE mit *text bookmark hyperlink* setzen für Inhaltsverzeichnis "
          ERROR="END"
          NAME="Rli.replaceLines"
          NEXT="prependTocToRli"
          POSX="800"
          POSY="2700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            COLUMN01="TOCTYPE=text bookmark hyperlink"
            FILTER_VALUE="pdf"
            RLICOLUMNDATA="COLUMN"
            RLIC_FILTER="CURRFILETYPE"
            />
          <MAPPING/>
        </fillTocTypeColumnCOPY>
        <findDuplicateLines
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Rli.findDuplicateLines"
          NEXT="DoNotMergeDuplicates"
          POSX="600"
          POSY="700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            RliColumnList="Art Dokument Teil Version Beschreibung Status"
            />
        </findDuplicateLines>
        <getFileNamesFromRli
          COMMENT="ermittle Dateiliste aus Reproliste für PDF Merge	"
          ERROR="ErrorHandling"
          NAME="Rli.getFileNames"
          NEXT="mergeCoverTocAndAllDocs"
          POSX="400"
          POSY="3700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            FilterOperator="=~"
            FilterValue="/\.pdf$/"
            RlicFilter="CURRFILENAME"
            />
          <MAPPING
            FilterOperator="%IgnoreDuplicates_FilterOperator%"
            FilterValue="%IgnoreDuplicates_FilterValue%"
            RlicFilter="%IgnoreDuplicates_RlicFilter%"
            />
        </getFileNamesFromRli>
        <getPageNumbersFromRli
          COMMENT="ermittle Seitenzahlen aller PDFs aus der RLI"
          ERROR="ErrorHandling"
          NAME="Rli.getPageNumbers"
          NEXT="fillEmptyPageNumbers"
          POSX="400"
          POSY="1700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </getPageNumbersFromRli>
        <ifCopyTargetDir
          COMMENT=""
          ELSE="Publish.userExitPostprocessRli1"
          OPERATOR="exists"
          POSX="400"
          POSY="4900"
          PROPERTY="COPY_TARGETDIR"
          THEN="AddPathToTargetFileNames"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="DIRECT"
            />
        </ifCopyTargetDir>
        <ifCopyTargetPdf
          COMMENT=""
          ELSE="Publish.userExitPostprocessRli1"
          OPERATOR="exists"
          POSX="600"
          POSY="5100"
          PROPERTY="COPY_TARGETFILE"
          THEN="createTargetPath"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="HORIZONTAL"
            THEN="DIRECT"
            />
        </ifCopyTargetPdf>
        <ifCover
          COMMENT="Soll ein Deckblatt erzeugt werden?"
          ELSE="IfToc"
          OPERATOR="is true"
          POSX="400"
          POSY="2300"
          PROPERTY="WANT_COVER"
          THEN="userExitBeforeCover"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifCover>
        <ifCover2
          COMMENT="Wurde ein Deckblatt erzeugt?"
          ELSE="ifDecrypt"
          OPERATOR="is true"
          POSX="400"
          POSY="2900"
          PROPERTY="WANT_COVER"
          THEN="prependCoverToRli"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifCover2>
        <ifCoverCOPY
          COMMENT="Soll ein Deckblatt erzeugt werden?"
          ELSE="WantCustomPageNumberCollection"
          OPERATOR="is true"
          POSX="400"
          POSY="1300"
          PROPERTY="WANT_CONVERSION"
          THEN="ActivateConversionOfAllNonPdfs"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifCoverCOPY>
        <ifCurrFileIsRli
          COMMENT="Handelt es sich um eine Reproliste?"
          ELSE="ErrorHandling"
          OPERATOR="ends with"
          POSX="400"
          POSY="500"
          PROPERTY="CURRRLIFILENAME"
          THEN="IfIgnoreDuplicates"
          TYPE="IF-THEN-ELSE"
          VALUE="rli"
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="DIRECT"
            />
        </ifCurrFileIsRli>
        <ifDecrypt
          COMMENT=""
          ELSE="Publish.UserExitBeforeOutputTypeSelection1"
          OPERATOR="is true"
          POSX="400"
          POSY="3100"
          PROPERTY="WANT_DECRYPTION"
          THEN="DecryptAllPdfs"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifDecrypt>
        <ifRliFileExists
          COMMENT=""
          ELSE="setRliFileName"
          OPERATOR="exists"
          POSX="400"
          POSY="100"
          PROPERTY="CURRRLIFILENAME"
          THEN="setCopyRetry"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifRliFileExists>
        <ifSingleConvert
          COMMENT="Bei Singleconvert wird nur pro RLI-Zeile nach PDF konvertiert und bestempelt. Die PDF wird gleich im Workflow Rli.convertFilesHelper an den Zielort kopiert."
          ELSE="WantCustomPageNumberCollection"
          OPERATOR="is true"
          POSX="700"
          POSY="1500"
          PROPERTY="SINGLE_CONVERT"
          THEN="Publish.userExitPostprocessRli1"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="HORIZONTAL"
            />
        </ifSingleConvert>
        <mergeCoverTocAndAllDocs
          COMMENT="Merge aller PDF-Dateien (Deckblatt, Inhaltsverzeichnis und alle Dokumente)"
          ERROR="ErrorHandling"
          NAME="Pdf.merge"
          NEXT="IfToc3"
          POSX="400"
          POSY="3900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            CURRFILENAME000001=""
            CURRFILENAME00000N=""
            NAME="DEFAULTS"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING/>
        </mergeCoverTocAndAllDocs>
        <prependCoverToRli
          COMMENT="Deckblatt vorne in Reproliste eintragen"
          ERROR="ErrorHandling"
          NAME="Rli.appendLine"
          NEXT="ifDecrypt"
          POSX="600"
          POSY="2900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            PREPEND_RLI_LINE="Y"
            RLICOLUMNDATA01="CURRFILENAME=%COVERFILENAME%"
            RLICOLUMNDATA02="CURRFILETYPE=pdf"
            RLICOLUMNDATA03="SKIP_STAMP=%SKIP_STAMP_COVER%"
            RLICOLUMNDATA04="PAGECOUNT=%COVER_PAGECOUNT%"
            RLICOLUMNDATA05="TargetFileName=%CUSTOMER_COVER_FILE_NAME%"
            RLICOLUMNDATA06="RelFileName=%CUSTOMER_COVER_FILE_NAME%"
            RLICOLUMNDATA="RLICOLUMNDATA"
            SKIP_STAMP_COVER="X"
            />
          <MAPPING/>
        </prependCoverToRli>
        <prependTocToRli
          COMMENT="Inhaltsverzeichnis vorne in Reproliste eintragen"
          ERROR="ErrorHandling"
          NAME="Rli.appendLine"
          NEXT="ifCover2"
          POSX="600"
          POSY="2700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            PREPEND_RLI_LINE="Y"
            RLICOLUMNDATA01="CURRFILENAME=%TOC%"
            RLICOLUMNDATA02="CURRFILETYPE=pdf"
            RLICOLUMNDATA03="SKIP_STAMP=%SKIP_STAMP_TOC%"
            RLICOLUMNDATA04="PAGECOUNT=%TOC_PAGENUM%"
            RLICOLUMNDATA05="TargetFileName=%CUSTOMER_TOC_FILE_NAME%"
            RLICOLUMNDATA06="RelFileName=%CUSTOMER_TOC_FILE_NAME%"
            RLICOLUMNDATA="RLICOLUMNDATA"
            SKIP_STAMP_TOC="X"
            />
          <MAPPING/>
        </prependTocToRli>
        <readRliSections
          COMMENT="Lies Standardwerte aus der Reproliste"
          ERROR="ErrorHandling"
          NAME="Rli.readSections"
          NEXT="ifCoverCOPY"
          POSX="200"
          POSY="1100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </readRliSections>
        <sendMail
          COMMENT=""
          ERROR="ErrorHandling"
          NAME="Mail.sendMail"
          NEXT="END"
          POSX="700"
          POSY="6500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            MAIL_EXPAND_TEXT="N"
            MAIL_FROM="cFolder@test.com"
            MAIL_SMTP="sepp.de"
            MAIL_SUBJECT="cFolder %JOBNUMBER%"
            MAIL_TEXT="Here comes your compressed cFolder content %SUMMARYTEXT%"
            NAME="DEFAULTS"
            >
            <WU_ENABLE_DEBUG_LOOP
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            MAIL_ATTACH_PROPERTIES="COMPRESSEDFILE SUMMARYFILE"
            />
        </sendMail>
        <setBookmarks
          COMMENT="trage Bookmarks und Hyperlinks in gemergtes PDF ein"
          ERROR="ErrorHandling"
          NAME="Publish.setBookmarks"
          NEXT="IfPageNumbers"
          POSX="200"
          POSY="4100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            NAME="DEFAULTS"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING/>
        </setBookmarks>
        <setCopyRetry
          COMMENT="setze RLI Auftragsdatei"
          NEXT="ifCurrFileIsRli"
          POSX="400"
          POSY="300"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            COPY_RETRY="5"
            />
        </setCopyRetry>
        <setRliFileName
          COMMENT="setze RLI Auftragsdatei"
          NEXT="setCopyRetry"
          POSX="600"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="HORIZONTAL"
            />
          <SET
            CURRRLIFILENAME="%CURRFILENAME%"
            />
        </setRliFileName>
        <stampPageNumbers
          COMMENT="laufende Seitennummer auf gemergtes PDF stempeln"
          ERROR="ErrorHandling"
          NAME="Publish.stampPageNumbers"
          NEXT="Publish.userExitBeforeCopyTarget1"
          POSX="200"
          POSY="4700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS
            FILTER_VALUE=""
            NAME="DEFAULTS"
            RLIC_FILTER="SKIP_STAMP"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING/>
        </stampPageNumbers>
        <userExitBeforeCover
          COMMENT=""
          ERROR="ErrorHandling"
          NEXT="createCoverSheet"
          POSX="600"
          POSY="2300"
          TYPE="SWF"
          USE="Publish.userExitBeforeCover"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </userExitBeforeCover>
        <userExitBeforeToc
          COMMENT="user exit before bulding toc"
          ERROR="ErrorHandling"
          NEXT="createToc"
          POSX="600"
          POSY="2500"
          TYPE="SWF"
          USE="Publish.userExitBeforeToc"
          >
          <CONNECTIONS
            ERROR="VERTICAL"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </userExitBeforeToc>
      </Publish.createDocument>
    </workflows>
  </config>
</DPF>
