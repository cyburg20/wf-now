<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <convertwiz_appkonv
        COMMENT="convertwiz - PROCESS FOR CONVERTWIZ APPLICATION CONVERSIONS"
        DPFINT-Type="WorkflowDescription"
        NAME="Convertwiz - SubProcess convertwiz_appkonv"
        PROJECT="CONVERTWIZ"
        VERSION="$Id: wf-convertwiz_appkonv.xml,v 1.11 2011/10/27 14:48:32 dh Exp $"
        >
        <CONVERTWIZ.Convertwiz_User_Pre_Convert1
          COMMENT=""
          ERROR="END"
          NEXT="check_how_to_convert"
          POSX="100"
          POSY="100"
          TYPE="SWF"
          USE="CONVERTWIZ.Convertwiz_User_Pre_Convert"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="VERTICAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </CONVERTWIZ.Convertwiz_User_Pre_Convert1>
        <CONVERTWIZ.check_office_version
          COMMENT=""
          ERROR="END"
          NAME="CONVERTWIZ.check_office_version"
          NEXT="set_for_use_sealexecute"
          POSX="600"
          POSY="900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            CW_OFFICE_MAJOR_VERSION=""
            />
        </CONVERTWIZ.check_office_version>
        <CONVERTWIZ.conversion_native
          COMMENT=""
          ERROR="END"
          NAME="CONVERTWIZ.conversion_native"
          NEXT="IF-THEN-ELSE1"
          POSX="1000"
          POSY="400"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING
            APPKONV_CONFIG_DIR_DEFAULT="%DPFSRV%/conf/dpf4convertwiz/appkonv"
            />
        </CONVERTWIZ.conversion_native>
        <CONVERTWIZ.conversion_office_10
          COMMENT=""
          ERROR="END"
          NAME="CONVERTWIZ.conversion_office_10"
          NEXT="check_for_user_exit"
          POSX="1200"
          POSY="700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            APPKONV_CONFIG_DIR_DEFAULT="%DPFSRV%/conf/dpf4convertwiz/appkonv"
            />
        </CONVERTWIZ.conversion_office_10>
        <CONVERTWIZ.conversion_office_11
          COMMENT=""
          ERROR="END"
          NAME="CONVERTWIZ.conversion_office_11"
          NEXT="check_for_user_exit"
          POSX="1200"
          POSY="800"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            APPKONV_CONFIG_DIR_DEFAULT="%DPFSRV%/conf/dpf4convertwiz/appkonv"
            />
        </CONVERTWIZ.conversion_office_11>
        <CONVERTWIZ.conversion_office_12
          COMMENT=""
          ERROR="END"
          NAME="CONVERTWIZ.conversion_office_12"
          NEXT="check_for_user_exit"
          POSX="1200"
          POSY="900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            APPKONV_CONFIG_DIR_DEFAULT="%DPFSRV%/conf/dpf4convertwiz/appkonv"
            />
        </CONVERTWIZ.conversion_office_12>
        <CONVERTWIZ.convertwiz_user_post_convert1
          COMMENT=""
          ERROR="END"
          NEXT="check_for_stampfile"
          POSX="1700"
          POSY="500"
          TYPE="SWF"
          USE="CONVERTWIZ.convertwiz_user_post_convert"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </CONVERTWIZ.convertwiz_user_post_convert1>
        <CONVERTWIZ.copy_metadata1
          COMMENT=""
          ERROR="END"
          NAME="CONVERTWIZ.copy_metadata"
          NEXT="check_for_user_exit"
          POSX="1400"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </CONVERTWIZ.copy_metadata1>
        <DEFAULTS/>
        <DPF4CONVERT.pdfstamp1
          COMMENT=""
          ERROR="END"
          NAME="pdfstamp"
          NEXT="END"
          POSX="2500"
          POSY="700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            DPF4C_PDFSTAMP_DB_FILE="default.db"
            DPF4C_PDFSTAMP_STP_FILE="default.stp"
            DPF4C_PDFSTAMP_TXT_FILE="%PLSROOT%tools/convcfg/pdfstamp/default.txt"
            USE_DEFAULT_TXT_FILE="N"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING/>
        </DPF4CONVERT.pdfstamp1>
        <END
          COMMENT=""
          NAME="END"
          POSX="1300"
          POSY="300"
          TYPE="STOP"
          />
        <FileTransfer.mv1
          COMMENT=""
          ERROR="END"
          NAME="FileTransfer.mv"
          NEXT="MODIFY2"
          POSX="1100"
          POSY="0"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            SOURCE="%CURRFILENAME%"
            TARGET="%TARGETDIR%/%TARGETFILE%"
            />
        </FileTransfer.mv1>
        <IF-THEN-ELSE1
          COMMENT=""
          ELSE="check_for_user_exit"
          OPERATOR="eq"
          POSX="1200"
          POSY="500"
          PROPERTY="CW_DO_META_COPY"
          THEN="CONVERTWIZ.copy_metadata1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE1>
        <MAIN
          BEGIN="check_for_user_exit_pre_convert"
          ERROR="END"
          LOGLEVEL="I"
          />
        <MAPPING/>
        <MODIFY1
          COMMENT=""
          NEXT="CONVERTWIZ.conversion_native"
          POSX="700"
          POSY="500"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="VERTICAL"
            />
          <SET
            CW_DO_META_COPY="Y"
            CW_META_INPUT_FILE="%CURRFILENAME%"
            />
        </MODIFY1>
        <MODIFY2
          COMMENT=""
          NEXT="check_for_user_exit"
          POSX="1300"
          POSY="0"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="VERTICAL"
            />
          <SET
            CURRFILENAME="%TARGETDIR%/%TARGETFILE%"
            />
        </MODIFY2>
        <SWITCH_CW_OFFICE_MAJOR_VERSION
          CASE:V10="CONVERTWIZ.conversion_office_10"
          CASE:V11="CONVERTWIZ.conversion_office_11"
          CASE:V12="CONVERTWIZ.conversion_office_12"
          COMMENT=""
          CONNECTION:DEFAULT="DIRECT"
          CONNECTION:V10="HORIZONTAL"
          CONNECTION:V11="HORIZONTAL"
          CONNECTION:V12="DIRECT"
          DEFAULT="CONVERTWIZ.conversion_office_12"
          POSX="1000"
          POSY="900"
          PROPERTY="CW_OFFICE_MAJOR_VERSION"
          TYPE="SWITCH"
          />
        <SWITCH_IS_OFFICE_FORMAT
          CASE:ai="CONVERTWIZ.conversion_native"
          CASE:cgm="CONVERTWIZ.conversion_native"
          CASE:doc="CONVERTWIZ.check_office_version"
          CASE:docm="CONVERTWIZ.check_office_version"
          CASE:docx="CONVERTWIZ.check_office_version"
          CASE:dot="CONVERTWIZ.check_office_version"
          CASE:dotm="CONVERTWIZ.check_office_version"
          CASE:dotx="CONVERTWIZ.check_office_version"
          CASE:eps="CONVERTWIZ.conversion_native"
          CASE:hp2="CONVERTWIZ.conversion_native"
          CASE:hp="CONVERTWIZ.conversion_native"
          CASE:hpgl="CONVERTWIZ.conversion_native"
          CASE:jpe="CONVERTWIZ.conversion_native"
          CASE:jpeg="CONVERTWIZ.conversion_native"
          CASE:jpg="CONVERTWIZ.conversion_native"
          CASE:pdf="MODIFY1"
          CASE:pdx="MODIFY1"
          CASE:plt="CONVERTWIZ.conversion_native"
          CASE:potm="CONVERTWIZ.check_office_version"
          CASE:potx="CONVERTWIZ.check_office_version"
          CASE:pps="CONVERTWIZ.check_office_version"
          CASE:ppsm="CONVERTWIZ.check_office_version"
          CASE:ppsx="CONVERTWIZ.check_office_version"
          CASE:ppt="CONVERTWIZ.check_office_version"
          CASE:pptm="CONVERTWIZ.check_office_version"
          CASE:pptx="CONVERTWIZ.check_office_version"
          CASE:ppz="CONVERTWIZ.check_office_version"
          CASE:ps="CONVERTWIZ.conversion_native"
          CASE:rtf="CONVERTWIZ.check_office_version"
          CASE:spl="CONVERTWIZ.conversion_native"
          CASE:tif="CONVERTWIZ.conversion_native"
          CASE:tiff="CONVERTWIZ.conversion_native"
          CASE:xls="CONVERTWIZ.check_office_version"
          CASE:xlsb="CONVERTWIZ.check_office_version"
          CASE:xlsm="CONVERTWIZ.check_office_version"
          CASE:xlst="CONVERTWIZ.check_office_version"
          CASE:xlsx="CONVERTWIZ.check_office_version"
          CASE:xlt="CONVERTWIZ.check_office_version"
          CASE:xltm="CONVERTWIZ.check_office_version"
          COMMENT=""
          CONNECTION:DEFAULT="DIRECT"
          CONNECTION:ai="DIRECT"
          CONNECTION:cgm="DIRECT"
          CONNECTION:doc="HORIZONTAL"
          CONNECTION:docm="DIRECT"
          CONNECTION:docx="DIRECT"
          CONNECTION:dot="DIRECT"
          CONNECTION:dotm="DIRECT"
          CONNECTION:dotx="DIRECT"
          CONNECTION:eps="DIRECT"
          CONNECTION:hp2="DIRECT"
          CONNECTION:hp="DIRECT"
          CONNECTION:hpgl="DIRECT"
          CONNECTION:jpe="DIRECT"
          CONNECTION:jpeg="DIRECT"
          CONNECTION:jpg="DIRECT"
          CONNECTION:pdf="DIRECT"
          CONNECTION:pdx="DIRECT"
          CONNECTION:plt="DIRECT"
          CONNECTION:potm="DIRECT"
          CONNECTION:potx="DIRECT"
          CONNECTION:pps="DIRECT"
          CONNECTION:ppsm="DIRECT"
          CONNECTION:ppsx="DIRECT"
          CONNECTION:ppt="DIRECT"
          CONNECTION:pptm="DIRECT"
          CONNECTION:pptx="DIRECT"
          CONNECTION:ppz="DIRECT"
          CONNECTION:ps="DIRECT"
          CONNECTION:rtf="DIRECT"
          CONNECTION:spl="DIRECT"
          CONNECTION:tif="DIRECT"
          CONNECTION:tiff="DIRECT"
          CONNECTION:xls="DIRECT"
          CONNECTION:xlsb="DIRECT"
          CONNECTION:xlsm="DIRECT"
          CONNECTION:xlst="DIRECT"
          CONNECTION:xlsx="DIRECT"
          CONNECTION:xlt="DIRECT"
          CONNECTION:xltm="DIRECT"
          DEFAULT="END"
          POSX="500"
          POSY="300"
          PROPERTY="CURRFILETYPE"
          TYPE="SWITCH"
          />
        <check_for_move_file
          COMMENT=""
          ELSE="check_for_user_exit"
          OPERATOR="eq"
          POSX="900"
          POSY="100"
          PROPERTY="CW_DO_MOVE_FILES_TO_TARGETFILE"
          THEN="FileTransfer.mv1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="DIRECT"
            />
        </check_for_move_file>
        <check_for_stampfile
          COMMENT=""
          ELSE="END"
          OPERATOR="exists"
          POSX="1900"
          POSY="700"
          PROPERTY="STAMPFILE"
          THEN="check_for_stampfile_none"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_for_stampfile>
        <check_for_stampfile_none
          COMMENT=""
          ELSE="END"
          OPERATOR="ne"
          POSX="2100"
          POSY="700"
          PROPERTY="STAMPFILE"
          THEN="setup_for_stamping"
          TYPE="IF-THEN-ELSE"
          VALUE="none"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_for_stampfile_none>
        <check_for_user_exit
          COMMENT=""
          ELSE="check_for_stampfile"
          OPERATOR="eq"
          POSX="1600"
          POSY="700"
          PROPERTY="CONVERTWIZ_SWITCH_DO_USER_POST_CONVERT"
          THEN="CONVERTWIZ.convertwiz_user_post_convert1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_for_user_exit>
        <check_for_user_exit_pre_convert
          COMMENT=""
          ELSE="check_how_to_convert"
          OPERATOR="eq"
          POSX="100"
          POSY="300"
          PROPERTY="CONVERTWIZ_SWITCH_DO_USER_PRE_START"
          THEN="CONVERTWIZ.Convertwiz_User_Pre_Convert1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_for_user_exit_pre_convert>
        <check_how_to_convert
          COMMENT=""
          ELSE="SWITCH_IS_OFFICE_FORMAT"
          OPERATOR="contains"
          POSX="300"
          POSY="300"
          PROPERTY="CW_FILETYPES_FOR_DPF4C_CONVERT"
          THEN="convert_native"
          TYPE="IF-THEN-ELSE"
          VALUE=",%CURRFILETYPE%,"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="HORIZONTAL"
            />
        </check_how_to_convert>
        <convert_native
          COMMENT=""
          ERROR="END"
          NEXT="check_for_move_file"
          POSX="700"
          POSY="100"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_native"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </convert_native>
        <exit_process
          NAME="exit_process"
          NEXT="END"
          />
        <set_for_use_sealexecute
          COMMENT=""
          NEXT="SWITCH_CW_OFFICE_MAJOR_VERSION"
          POSX="800"
          POSY="900"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_USE_OWN_CONTEXT="Y"
            />
        </set_for_use_sealexecute>
        <setup_for_stamping
          COMMENT=""
          NEXT="DPF4CONVERT.pdfstamp1"
          POSX="2300"
          POSY="700"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_MODIFY_STAMP_N_TEXT9="%JOBNAME%"
            DPF4C_PDFSTAMP_STP_FILE="%STAMPFILE%"
            />
        </setup_for_stamping>
      </convertwiz_appkonv>
    </workflows>
  </config>
</DPF>
