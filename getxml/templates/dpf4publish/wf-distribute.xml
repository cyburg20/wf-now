<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <DPF4Publish.Distribute
        COMMENT=""
        DPFINT-Customer="0"
        DPFINT-Interactive="0"
        DPFINT-Type="WorkflowDescription"
        NAME="Distribute"
        PROJECT="DPF4Publish"
        VERSION="$Id: wf-distribute.xml,v 1.14 2013/02/12 14:49:44 sek Exp $"
        >
        <CollectLinkedPdfsToStructuredPdf
          COMMENT=""
          ERROR="END"
          NAME="Pdf.CollectLinkedPdfsToStructuredPdf"
          NEXT="SetOutType"
          POSX="700"
          POSY="1100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            TargetFileName="%OutputDirectory%/%MergedPdfFileName%"
            />
        </CollectLinkedPdfsToStructuredPdf>
        <CopyMergedPdfToOutput
          COMMENT="Copy the merged pdf file to the output directory."
          ERROR="END"
          NAME="FileTransfer.copyFiles"
          NEXT="SetOutType"
          POSX="300"
          POSY="1100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            COPY_DEBUG="N"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING
            COPY_TARGET_PROPERTIES="OutputPath"
            OutputPath="%OutputDirectory%/%MergedPdfFileName%"
            />
        </CopyMergedPdfToOutput>
        <CopyPdfsToOutput
          COMMENT="Copy documents to the output directory."
          ERROR="END"
          NAME="Rli.copyFiles"
          NEXT="IfWantCollection"
          POSX="500"
          POSY="900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            AutoTargetFileName="N"
            IgnoreMissingFiles="N"
            SourceFileRlic="CurrFileName"
            TargetFileRlic="TargetFileName"
            />
          <MAPPING
            AutoTargetFileName="%CopyPdfsToOutputAutoTargetFileName%"
            FilterPrefix="%WFPOSITION%"
            SourceFileRlic="%CopyPdfsToOutputSourceFileRlic%"
            TargetFileRlic="%CopyPdfsToOutputTargetFileRlic%"
            />
        </CopyPdfsToOutput>
        <CreateCdLabel
          COMMENT="create CD/DVD label"
          ERROR="END"
          NAME="CdRobot.createCdLabel"
          NEXT="IfWantMergePdfs70"
          POSX="300"
          POSY="700"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            DEFAULT_FONT="%CdLabelTextFont%"
            DEFAULT_SIZE="%CdLabelTextSize%"
            DestFileName="%CdLabelFileName%"
            IMAGE_LIST="%CdImageList%"
            LABEL_BACKGROUND="%CdLabelBackgroundPdf%"
            LABEL_LIST="%CdLabelList%"
            />
        </CreateCdLabel>
        <CreateOutputDirectoryPath
          COMMENT="Create the output directory."
          ERROR="END"
          NAME="FileSystem.mkPath"
          NEXT="ifWantCdLabel"
          POSX="100"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            DIRECTORY=""
            />
          <MAPPING
            DIRECTORY="%OutputDirectory%"
            />
        </CreateOutputDirectoryPath>
        <DEFAULTS
          DPF4Publish.UserExitBeforeDistribute="DPF4Publish.UserExitBeforeDistribute"
          WantDistribute="Y"
          />
        <END
          COMMENT=""
          NAME="END"
          POSX="100"
          POSY="1300"
          TYPE="STOP"
          />
        <IfWantCollection
          COMMENT="Were the documents merged to one pdf file?"
          ELSE="END"
          OPERATOR="=~"
          POSX="700"
          POSY="900"
          PROPERTY="WantMergePdfs"
          THEN="ReadTocFileNameFromRli"
          TYPE="IF-THEN-ELSE"
          VALUE="collection"
          >
          <CONNECTIONS
            THEN="DIRECT"
            />
        </IfWantCollection>
        <IfWantMergePdfs70
          COMMENT="Were the documents merged to one pdf file?"
          ELSE="SetTargetFileNames"
          OPERATOR="is true"
          POSX="100"
          POSY="900"
          PROPERTY="WantMergePdfs"
          THEN="CopyMergedPdfToOutput"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IfWantMergePdfs70>
        <MAIN
          BEGIN="UserExitBeforeDistribute"
          NAME=""
          />
        <MAPPING/>
        <ReadTocFileNameFromRli
          COMMENT=""
          ERROR="END"
          NAME="Rli.readRliLine"
          NEXT="SetCurrFileName"
          POSX="900"
          POSY="900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            Columns="TargetFileName"
            RliLine="2"
            />
        </ReadTocFileNameFromRli>
        <Send2Webportal
          COMMENT=""
          ERROR="END"
          NAME="FileTransfer.send2webportal"
          NEXT="END"
          POSX="700"
          POSY="1300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <KEEP_FILES
              val="N"
              />
            <WU_ENABLE_DEBUG_LOOP
              val="N"
              />
          </DEFAULTS>
          <MAPPING
            BASE_URL="%WEBPORTAL_BASE_URL%"
            FILE_LIST="%JOBDIR%/webportal.filelist.txt"
            KEEP_FILES="Y"
            MAIL_FROM="%PLS_SENDER%"
            MAIL_TO="%PLS_RECEIVER%"
            />
        </Send2Webportal>
        <SetCurrFileName
          COMMENT=""
          NEXT="CollectLinkedPdfsToStructuredPdf"
          POSX="900"
          POSY="1100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            CurrFileName="%TargetFileName%"
            />
        </SetCurrFileName>
        <SetOutType
          CASE:HD="END"
          CASE:Webportal="WriteWebportalFileList"
          COMMENT="Select one of these output types: CD, DVD, HD (default), Mail, Netdome or Webportal."
          CONNECTION:DEFAULT="DIRECT"
          CONNECTION:HD="DIRECT"
          CONNECTION:Webportal="DIRECT"
          DEFAULT="END"
          POSX="300"
          POSY="1300"
          PROPERTY="OutputType"
          TYPE="SWITCH"
          />
        <SetTargetFileNames
          COMMENT="Set full file paths to copy documents to."
          ERROR="END"
          NAME="Rli.fillRliColumn"
          NEXT="CopyPdfsToOutput"
          POSX="300"
          POSY="900"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            Replacement="_"
            WuEnableDebugLoop="N"
            />
          <MAPPING
            FillColumn="TargetFileName"
            FillData="%OutputDirectory%/%RelFileName%"
            FilterOperator="-f"
            RlicFilter="CurrFileName"
            />
        </SetTargetFileNames>
        <UserExitBeforeDistribute
          COMMENT="user exit before standard distribute process.

customize it in publish.customer.ini with keyword 


DPF4Publish.UserExitBeforeDistribute = ...


use internal process name to call instead empty default."
          ERROR="END"
          NEXT="ifWantDistribute"
          POSX="100"
          POSY="100"
          TYPE="USER_EXIST"
          USE="%DPF4Publish.UserExitBeforeDistribute%"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </UserExitBeforeDistribute>
        <WriteWebportalFileList
          COMMENT=""
          ERROR="END"
          NAME="FileSystem.WriteFile"
          NEXT="Send2Webportal"
          POSX="500"
          POSY="1300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            FILE="%JOBDIR%/webportal.filelist.txt"
            Line1="[%TARGETFILENAME.fileName%]"
            Line2="file = %TARGETFILENAME%"
            />
        </WriteWebportalFileList>
        <ifWantCdLabel
          COMMENT=""
          ELSE="IfWantMergePdfs70"
          OPERATOR="is true"
          POSX="100"
          POSY="700"
          PROPERTY="WantCdLabel"
          THEN="CreateCdLabel"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifWantCdLabel>
        <ifWantDistribute
          COMMENT=""
          ELSE="END"
          OPERATOR="is true"
          POSX="100"
          POSY="300"
          PROPERTY="WantDistribute"
          THEN="CreateOutputDirectoryPath"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </ifWantDistribute>
      </DPF4Publish.Distribute>
    </workflows>
  </config>
</DPF>
