<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <DPF4LOADER.sapdmsloader_Copy
        COMMENT=""
        DPFINT-Customer="0"
        DPFINT-Interactive="0"
        DPFINT-Type="WorkflowDescription"
        NAME="Document Load - Subprocess SAP DMS Loader_Copy"
        PROJECT="DPF4LOADER"
        VERSION="$Id: wf-sapdmsloader_copy.xml,v 1.2 2013/10/14 08:06:24 tobias Exp $"
        >
        <DEFAULTS/>
        <DPF4LOADER.dpf4loader_error_mail1
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="1700"
          POSY="700"
          TYPE="SWF"
          USE="DPF4LOADER.dpf4loader_error_mail"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4LOADER.dpf4loader_error_mail1>
        <DPF4VIEW.prepare_single1
          COMMENT=""
          ERROR="DPF4LOADER.dpf4loader_error_mail1"
          NEXT="IF-THEN-ELSE_rename"
          POSX="1300"
          POSY="500"
          TYPE="SWF"
          USE="DPF4VIEW.prepare_single"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4VIEW.prepare_single1>
        <END
          COMMENT=""
          NAME="END"
          POSX="2800"
          POSY="300"
          TYPE="STOP"
          />
        <FileSystem.ReadMultipleIniFiles1COPY1
          COMMENT=""
          ERROR="DPF4LOADER.dpf4loader_error_mail1"
          NAME="FileSystem.ReadMultipleIniFiles"
          NEXT="MODIFY1COPY"
          POSX="300"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <ForceIniValues
              val="N"
              />
            <IniFileName
              val="%PLSSV%/dpf/conf/dpf4publish/publish.ini"
              />
            <OptionalFirstIniFile
              val="N"
              />
            <OverwriteDefaultValues
              val="N"
              />
            <SectionNames
              val="MAIN"
              />
          </DEFAULTS>
          <MAPPING
            IniFileName="%DPFSRV%\conf\dpf4loader\dpf4loader.ini"
            SecondIniFileName="%SEAL_CUSTOMDIR%\server\dpf\conf\dpf4loader\dpf4loader.ini"
            SectionNames="MAIN,DPF4LOADER,DEFAULTS,%CurrFileType.toUpper%,%DPFL_VARIANT%,%DPFL_VARIANT%_%CurrFileType.toUpper%"
            />
        </FileSystem.ReadMultipleIniFiles1COPY1>
        <FileTransfer.mv1
          COMMENT=""
          ERROR="END"
          NAME="FileTransfer.mv"
          NEXT="SetCurrFilename"
          POSX="1800"
          POSY="0"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            SOURCE="%CurrFileName%"
            TARGET="%NewFileName%"
            />
        </FileTransfer.mv1>
        <IF-THEN-ELSE1
          COMMENT=""
          ELSE="read_hed"
          OPERATOR="eq"
          POSX="100"
          POSY="300"
          PROPERTY="DPFL_ConfigLoaded"
          THEN="IF-THEN-ELSE_DATA0_split"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE1>
        <IF-THEN-ELSE_DATA0_split
          COMMENT=""
          ELSE="IF-THEN-ELSE_DATA1_split"
          OPERATOR="contains"
          POSX="700"
          POSY="300"
          PROPERTY="%PLS_DATA_0%"
          THEN="String.split_Data0"
          TYPE="IF-THEN-ELSE"
          VALUE="|"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_DATA0_split>
        <IF-THEN-ELSE_DATA1_split
          COMMENT=""
          ELSE="IF-THEN-ELSE_convert"
          OPERATOR="contains"
          POSX="1100"
          POSY="300"
          PROPERTY="%PLS_DATA_1%"
          THEN="String.split_Data1"
          TYPE="IF-THEN-ELSE"
          VALUE="|"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_DATA1_split>
        <IF-THEN-ELSE_ERR_AFTER
          COMMENT=""
          ELSE="END"
          OPERATOR="begins with"
          POSX="2500"
          POSY="700"
          PROPERTY="SAPFUNC_AFTER_EXIT_ON_ERROR"
          THEN="MODIFY_JOBSTATUS"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_ERR_AFTER>
        <IF-THEN-ELSE_ERR_BEF
          COMMENT=""
          ELSE="MODIFY_RESET_JOBSTATUS"
          OPERATOR="begins with"
          POSX="2100"
          POSY="800"
          PROPERTY="SAPFUNC_BEFORE_EXIT_ON_ERROR"
          THEN="MODIFY_JOBSTATUS"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_ERR_BEF>
        <IF-THEN-ELSE_ERR_SAPCLI_AFTER
          COMMENT=""
          ELSE="END"
          OPERATOR="!="
          POSX="2500"
          POSY="500"
          PROPERTY="ExecuteSapFunctionErrorStatus"
          THEN="IF-THEN-ELSE_ERR_AFTER"
          TYPE="IF-THEN-ELSE"
          VALUE="0"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_ERR_SAPCLI_AFTER>
        <IF-THEN-ELSE_ERR_SAPCLI_BEFORE
          COMMENT=""
          ELSE="sapcheckin1"
          OPERATOR="!="
          POSX="2100"
          POSY="500"
          PROPERTY="ExecuteSapFunctionErrorStatus"
          THEN="IF-THEN-ELSE_ERR_BEF"
          TYPE="IF-THEN-ELSE"
          VALUE="0"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_ERR_SAPCLI_BEFORE>
        <IF-THEN-ELSE_convert
          COMMENT="Call a user-exit like DPF4Convert"
          ELSE="IF-THEN-ELSE_rename"
          OPERATOR="begins with"
          POSX="1300"
          POSY="300"
          PROPERTY="%DPFL_DOCONVERSION%"
          THEN="DPF4VIEW.prepare_single1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_convert>
        <IF-THEN-ELSE_empty_status
          COMMENT="old loader had a ! for empty status"
          ELSE="Sap.executeSapFunction_After"
          OPERATOR="eq"
          POSX="2500"
          POSY="100"
          PROPERTY="%SAPCHECKIN_DVS_STATUS%"
          THEN="MODIFY_status"
          TYPE="IF-THEN-ELSE"
          VALUE="!"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_empty_status>
        <IF-THEN-ELSE_rename
          COMMENT=""
          ELSE="Sap.executeSapFunction_Before"
          OPERATOR="exists"
          POSX="1500"
          POSY="300"
          PROPERTY="%TARGETFILENAME%"
          THEN="SetNewFilename"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE_rename>
        <MAIN
          BEGIN="IF-THEN-ELSE1"
          NAME=""
          />
        <MAPPING/>
        <MODIFY1COPY
          COMMENT=""
          NEXT="IF-THEN-ELSE_DATA0_split"
          POSX="500"
          POSY="400"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPFL_ConfigLoaded="Y"
            />
        </MODIFY1COPY>
        <MODIFY_JOBSTATUS
          COMMENT=""
          NEXT="DPF4LOADER.dpf4loader_error_mail1"
          POSX="1900"
          POSY="700"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            ERR_EXITCODE="%ExecuteSapFunctionErrorStatus%"
            ERR_JOBSTATUS="ERR_EXTERN_PROG_CALL"
            ERR_WFPOSITION="sapcli call"
            ERR_WUNAME="sap.executefunction"
            JOBSTATE="ERROR"
            JOBSTATUS="ERROR"
            />
        </MODIFY_JOBSTATUS>
        <MODIFY_RESET_JOBSTATUS
          COMMENT=""
          NEXT="sapcheckin1"
          POSX="2300"
          POSY="500"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            ERR_EXITCODE="0"
            ERR_JOBSTATUS=""
            ExecuteSapFunctionErrorStatus="0"
            JOBSTATE="OK"
            JOBSTATUS="OK"
            />
        </MODIFY_RESET_JOBSTATUS>
        <MODIFY_SplitResults_Data0
          COMMENT=""
          NEXT="IF-THEN-ELSE_DATA1_split"
          POSX="900"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            SAPCHECKIN_DVS_NUMBER="%TargetSplitParamData01%"
            SAPCHECKIN_DVS_PART="%TargetSplitParamData03%"
            SAPCHECKIN_DVS_TYPE="%TargetSplitParamData02%"
            SAPCHECKIN_DVS_VERSION="%TargetSplitParamData04%"
            />
        </MODIFY_SplitResults_Data0>
        <MODIFY_SplitResults_Data1
          COMMENT=""
          NEXT="IF-THEN-ELSE_convert"
          POSX="1300"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            SAPCHECKIN_DVS_FILE1OR2="%TargetSplitParam4%"
            SAPCHECKIN_LANGUAGE="%TargetSplitParam3%"
            SAPCHECKIN_MANDANT="%TargetSplitParam2%"
            SAPCHECKIN_SYSTEM="%TargetSplitParam1%"
            />
        </MODIFY_SplitResults_Data1>
        <MODIFY_status
          COMMENT="delete if it was !"
          NEXT="Sap.executeSapFunction_After"
          POSX="2700"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            SAPCHECKIN_DVS_STATUS=""
            />
        </MODIFY_status>
        <Sap.executeSapFunction_After
          COMMENT=""
          ERROR="END"
          NAME="Sap.executeSapFunction"
          NEXT="IF-THEN-ELSE_ERR_SAPCLI_AFTER"
          POSX="2500"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            ContinueDespiteSapCliErrors="Y"
            ExecuteSapFunctionErrorStatus="0"
            FunctionCall="%SAPFUNC_AFTER%"
            SAPLANGU="%SAPCHECKIN_LANGUAGE%"
            SAPMANDANT="%SAPCHECKIN_MANDANT%"
            SAPSYSTEM="%SAPCHECKIN_SYSTEM%"
            />
        </Sap.executeSapFunction_After>
        <Sap.executeSapFunction_Before
          COMMENT=""
          ERROR="END"
          NAME="Sap.executeSapFunction"
          NEXT="IF-THEN-ELSE_ERR_SAPCLI_BEFORE"
          POSX="2100"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING
            ContinueDespiteSapCliErrors="Y"
            ExecuteSapFunctionErrorStatus="0"
            FunctionCall="%SAPFUNC_BEFORE%"
            SAPLANGU="%SAPCHECKIN_LANGUAGE%"
            SAPMANDANT="%SAPCHECKIN_MANDANT%"
            SAPSYSTEM="%SAPCHECKIN_SYSTEM%"
            />
        </Sap.executeSapFunction_Before>
        <SetCurrFilename
          COMMENT=""
          NEXT="Sap.executeSapFunction_Before"
          POSX="2100"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            CurrFilename="%NewFileName%"
            />
        </SetCurrFilename>
        <SetNewFilename
          COMMENT="take the target filename from header plus current workdir as path"
          NEXT="FileTransfer.mv1"
          POSX="1500"
          POSY="100"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            NewFileName="%JobDir%/%TARGETFILENAME%"
            />
        </SetNewFilename>
        <String.split_Data0
          COMMENT=""
          ERROR="DPF4LOADER.dpf4loader_error_mail1"
          NAME="String.split"
          NEXT="MODIFY_SplitResults_Data0"
          POSX="700"
          POSY="100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            TargetParamsBaseName="TargetSplitParam"
            />
          <MAPPING
            SplitRegEx="|"
            String="%PLS_DATA_0%"
            TargetParamsBaseName="TargetSplitParamData0"
            />
        </String.split_Data0>
        <String.split_Data1
          COMMENT=""
          ERROR="DPF4LOADER.dpf4loader_error_mail1"
          NAME="String.split"
          NEXT="MODIFY_SplitResults_Data1"
          POSX="1100"
          POSY="100"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            TargetParamsBaseName="TargetSplitParam"
            />
          <MAPPING
            SplitRegEx="|"
            String="%PLS_DATA_1%"
            />
        </String.split_Data1>
        <read_hed
          COMMENT=""
          ERROR="DPF4LOADER.dpf4loader_error_mail1"
          NAME="read_hed"
          NEXT="FileSystem.ReadMultipleIniFiles1COPY1"
          POSX="100"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </read_hed>
        <sapcheckin1
          COMMENT=""
          ERROR="DPF4LOADER.dpf4loader_error_mail1"
          NAME="sapcheckin"
          NEXT="IF-THEN-ELSE_empty_status"
          POSX="2300"
          POSY="300"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS
            SAPCHECKIN_SKIP_SAP_CHECKIN="N"
            WU_ENABLE_DEBUG_LOOP="N"
            />
          <MAPPING/>
        </sapcheckin1>
      </DPF4LOADER.sapdmsloader_Copy>
    </workflows>
  </config>
</DPF>
