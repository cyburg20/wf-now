<?xml version="1.0" encoding="ISO-8859-1"?>
<DPF>
  <config>
    <workflows>
      <DPF4VIEW.prepare_single
        COMMENT=""
        DPFINT-Interactive="1"
        DPFINT-Type="WorkflowDescription"
        NAME="prepare_single"
        LICENSE="VIEW"
        PROJECT="DPF4VIEW"
        VERSION="$Id: wf-prepare_single.xml,v 1.10 2017/02/08 13:10:09 kig Exp $"
        >
        <DEFAULTS/>
        <DPF4CONVERT.convert_native1
          COMMENT=""
          ERROR="END"
          NEXT="DPF4CONVERT.pdfprocess1"
          POSX="300"
          POSY="1200"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_native"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.convert_native1>
        <DPF4CONVERT.convert_office1
          COMMENT=""
          ERROR="END"
          NEXT="DPF4CONVERT.pdfprocess1"
          POSX="500"
          POSY="1200"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_office"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.convert_office1>
        <DPF4CONVERT.convert_office2
          COMMENT=""
          ERROR="END"
          NEXT="DPF4CONVERT.pdfprocess1"
          POSX="600"
          POSY="1300"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_office"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.convert_office2>
        <DPF4CONVERT.convert_office3
          COMMENT=""
          ERROR="END"
          NEXT="DPF4CONVERT.pdfprocess1"
          POSX="700"
          POSY="1200"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_office"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.convert_office3>
        <DPF4CONVERT.convert_office4
          COMMENT=""
          ERROR="END"
          NEXT="DPF4CONVERT.pdfprocess1"
          POSX="800"
          POSY="1300"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_office"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.convert_office4>
        <DPF4CONVERT.convert_office5
          COMMENT=""
          ERROR="END"
          NEXT="DPF4CONVERT.pdfprocess1"
          POSX="900"
          POSY="1200"
          TYPE="SWF"
          USE="DPF4CONVERT.convert_office"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="HORIZONTAL"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.convert_office5>
        <DPF4CONVERT.net_put_data1
          COMMENT=""
          ERROR="sp-dpf4c_error"
          NEXT="MODIFY4"
          POSX="400"
          POSY="2200"
          TYPE="SWF"
          USE="DPF4CONVERT.net_put_data"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.net_put_data1>
        <DPF4CONVERT.pdfpostproc1
          COMMENT=""
          ERROR="END"
          NEXT="net_put_data"
          POSX="300"
          POSY="1800"
          TYPE="SWF"
          USE="DPF4CONVERT.pdfpostproc"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.pdfpostproc1>
        <DPF4CONVERT.pdfprocess1
          COMMENT=""
          ERROR="END"
          NEXT="IF-THEN-ELSE1"
          POSX="300"
          POSY="1400"
          TYPE="SWF"
          USE="DPF4CONVERT.pdfprocess"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.pdfprocess1>
        <DPF4CONVERT.readcustomconfig1
          COMMENT=""
          ERROR="END"
          NAME="DPF4CONVERT.readcustomconfig"
          NEXT="check_user_pre_conv"
          POSX="300"
          POSY="500"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4CONVERT.readcustomconfig1>
        <DPF4VIEW.dpf4view_user_pre_conv1
          COMMENT=""
          ERROR="END"
          NEXT="check_currfiletype"
          POSX="500"
          POSY="800"
          TYPE="SWF"
          USE="DPF4VIEW.dpf4view_user_pre_conv"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4VIEW.dpf4view_user_pre_conv1>
        <DPF4VIEW.version_dpf4v1
          COMMENT=""
          ERROR="END"
          NEXT="set_custom_config"
          POSX="300"
          POSY="100"
          TYPE="SWF"
          USE="DPF4VIEW.version_dpf4v"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </DPF4VIEW.version_dpf4v1>
        <END
          COMMENT=""
          NAME="END"
          POSX="600"
          POSY="1100"
          TYPE="STOP"
          />
        <IF-THEN-ELSE1
          COMMENT=""
          ELSE="DPF4CONVERT.pdfpostproc1"
          OPERATOR="eq"
          POSX="300"
          POSY="1600"
          PROPERTY="TARGET_FORMAT"
          THEN="pdf2tiff1"
          TYPE="IF-THEN-ELSE"
          VALUE="TIFF"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE1>
        <IF-THEN-ELSE2
          COMMENT=""
          ELSE="IF-THEN-ELSE3"
          OPERATOR="is file"
          POSX="500"
          POSY="400"
          PROPERTY="%SEAL_CUSTOMDIR%/server/dpf/conf/dpf4view/prepare_single.ini"
          THEN="DPF4CONVERT.readcustomconfig1"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE2>
        <IF-THEN-ELSE3
          COMMENT=""
          ELSE="check_user_pre_conv"
          OPERATOR="is file"
          POSX="600"
          POSY="500"
          PROPERTY="%PLSROOT%/server/dpf/conf/dpf4view/prepare_single.ini"
          THEN="DPF4CONVERT.readcustomconfig1"
          TYPE="IF-THEN-ELSE"
          VALUE=""
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </IF-THEN-ELSE3>
        <MAIN
          BEGIN="DPF4VIEW.version_dpf4v1"
          NAME=""
          />
        <MAPPING/>
        <MODIFY4
          COMMENT=""
          NEXT="END"
          POSX="300"
          POSY="2400"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPFJOBPROGRESS="100"
            />
        </MODIFY4>
        <check_currfiletype
          CASE:doc="DPF4CONVERT.convert_office2"
          CASE:docm="DPF4CONVERT.convert_office2"
          CASE:docx="DPF4CONVERT.convert_office2"
          CASE:dotm="DPF4CONVERT.convert_office2"
          CASE:dotx="DPF4CONVERT.convert_office2"
          CASE:mpp="DPF4CONVERT.convert_office1"
          CASE:mpv="DPF4CONVERT.convert_office1"
          CASE:potm="DPF4CONVERT.convert_office5"
          CASE:potx="DPF4CONVERT.convert_office5"
          CASE:pps="DPF4CONVERT.convert_office5"
          CASE:ppsm="DPF4CONVERT.convert_office5"
          CASE:ppsx="DPF4CONVERT.convert_office5"
          CASE:ppt="DPF4CONVERT.convert_office5"
          CASE:pptm="DPF4CONVERT.convert_office5"
          CASE:pptx="DPF4CONVERT.convert_office5"
          CASE:rtf="DPF4CONVERT.convert_office2"
          CASE:txt="DPF4CONVERT.convert_office2"
          CASE:vsd="DPF4CONVERT.convert_office3"
          CASE:xlam="DPF4CONVERT.convert_office4"
          CASE:xls="DPF4CONVERT.convert_office4"
          CASE:xlsb="DPF4CONVERT.convert_office4"
          CASE:xlsm="DPF4CONVERT.convert_office4"
          CASE:xlsx="DPF4CONVERT.convert_office4"
          CASE:xltm="DPF4CONVERT.convert_office4"
          CASE:xltx="DPF4CONVERT.convert_office4"
          COMMENT=""
          CONNECTION:DEFAULT="DIRECT"
          CONNECTION:doc="VERTICAL"
          CONNECTION:docm="VERTICAL"
          CONNECTION:docx="VERTICAL"
          CONNECTION:dotm="VERTICAL"
          CONNECTION:dotx="VERTICAL"
          CONNECTION:mpp="VERTICAL"
          CONNECTION:mpv="VERTICAL"
          CONNECTION:potm="VERTICAL"
          CONNECTION:potx="VERTICAL"
          CONNECTION:pps="VERTICAL"
          CONNECTION:ppsm="VERTICAL"
          CONNECTION:ppsx="VERTICAL"
          CONNECTION:ppt="VERTICAL"
          CONNECTION:pptm="VERTICAL"
          CONNECTION:pptx="VERTICAL"
          CONNECTION:rtf="VERTICAL"
          CONNECTION:txt="VERTICAL"
          CONNECTION:vsd="VERTICAL"
          CONNECTION:xlam="VERTICAL"
          CONNECTION:xls="VERTICAL"
          CONNECTION:xlsb="VERTICAL"
          CONNECTION:xlsm="VERTICAL"
          CONNECTION:xlsx="VERTICAL"
          CONNECTION:xltm="VERTICAL"
          CONNECTION:xltx="VERTICAL"
          DEFAULT="DPF4CONVERT.convert_native1"
          POSX="300"
          POSY="900"
          PROPERTY="CURRFILETYPE"
          TYPE="SWITCH"
          />
        <check_user_pre_conv
          COMMENT=""
          ELSE="check_currfiletype"
          OPERATOR="eq"
          POSX="300"
          POSY="700"
          PROPERTY="DPF4VIEW_SWITCH_USER_PRE_CONV"
          THEN="DPF4VIEW.dpf4view_user_pre_conv1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="DIRECT"
            THEN="DIRECT"
            />
        </check_user_pre_conv>
        <net_put_data
          COMMENT=""
          ELSE="MODIFY4"
          OPERATOR="eq"
          POSX="300"
          POSY="2000"
          PROPERTY="DPF4C_NET_PUT_DATA"
          THEN="DPF4CONVERT.net_put_data1"
          TYPE="IF-THEN-ELSE"
          VALUE="Y"
          >
          <CONNECTIONS
            ELSE="VERTICAL"
            THEN="DIRECT"
            />
        </net_put_data>
        <pdf2tiff1
          COMMENT=""
          ERROR="END"
          NAME="pdf2tiff"
          NEXT="END"
          POSX="500"
          POSY="1600"
          TYPE="WU"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS>
            <DPF4C_MODIFY_RESOLUTION_DPI
              val=""
              />
            <DPF4C_MODIFY_RESOLUTION_DPI_INTERMEDIA
              val=""
              />
            <DPF4C_PDF2TIFF_CFG_FILE
              val="%PLSROOT%tools/convcfg/pdf2tiff/default.cfg"
              />
            <DPF4C_PDF2TIFF_DB_FILE
              val="%PLSROOT%tools/convcfg/pdf2tiff/default.db"
              />
            <DPF4C_PDF2TIFF_EXT
              val=""
              />
            <PDF2TIFF_USE_BLACK_WHITE_MAPPING
              val="N"
              />
            <WU_ENABLE_DEBUG_LOOP
              val="N"
              />
          </DEFAULTS>
          <MAPPING/>
        </pdf2tiff1>
        <set_custom_config
          COMMENT=""
          NEXT="IF-THEN-ELSE2"
          POSX="300"
          POSY="300"
          TYPE="MODIFY"
          >
          <CONNECTIONS
            NEXT="DIRECT"
            />
          <SET
            DPF4C_CUSTOM_CONFIG="dpf4view::prepare_single"
            DPF4C_READ_CUSTOM_CONFIG_PDFPOSTPROC="N"
            DPF4C_READ_CUSTOM_CONFIG_PDFPROCESS="N"
            ORIGFILENAME="%CURRFILENAME%"
            />
        </set_custom_config>
        <sp-dpf4c_error
          COMMENT=""
          ERROR="END"
          NEXT="END"
          POSX="700"
          POSY="2200"
          TYPE="SWF"
          USE="dpf4c_error"
          >
          <CONNECTIONS
            ERROR="DIRECT"
            NEXT="DIRECT"
            />
          <DEFAULTS/>
          <MAPPING/>
        </sp-dpf4c_error>
      </DPF4VIEW.prepare_single>
    </workflows>
  </config>
</DPF>
